[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=031c3249-a7e0-49ea-a36c-198ad393ba69
Description=adb版监控
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Dim AdbPath
AdbPath = Form1.InputBox1.Text

Plugin.ofcmd.BindAdb AdbPath
test = Plugin.ofcmd.AdbVersion
TracePrint test


小精灵包名 = "com.mbmpmcmcmlnimnnlmp.dddfree"
//程序包名
海马玩报名 = "com.shouyou.sgzerq.hm"
包名360 = "com.game.sgz.a360"

//查看所有进程及内存占用等
Dim progressList
progressList = Plugin.ofcmd.Adb("shell ps")
If instr(progressList, 小精灵包名) > 0 Then 
	TracePrint "小精灵运行中"
Else 
	TracePrint "小精灵没了"
	//启动辅助
	//TracePrint Plugin.ofcmd.Adb("-s 127.0.0.1:26944 shell am start -n com.mbmpmcmcmlnimnnlmp.dddfree/com.cyjh.elfin.activity.SplashActivity")
	//这个activity可以跳过启动时的2段广告
	TracePrint Plugin.ofcmd.Adb("-s " & test & " shell am start -n com.mbmpmcmcmlnimnnlmp.dddfree/com.cyjh.elfin.activity.ElfinFreeActivity")
	Delay 15000
	
End If

If instr(progressList, 小精灵包名) > 0 Then 
	TracePrint "小精灵运行中"
Else 
	TracePrint "小精灵没了"
End If

//读取模拟器编号
test = Form1.Grid1.GetItemText(1, 0)
TracePrint test





//读取设置的平台
TracePrint Form1.ComboBox1.ListIndex
If Form1.ComboBox1.ListIndex = 0 Then 
    //运行海马玩客户端
    TracePrint Plugin.ofcmd.Adb("-s " & test & " shell am start -n com.shouyou.sgzerq.hm/com.youkia.gamecenter.GameCenterActivity")
ElseIf Form1.ComboBox1.ListIndex = 2
    //运行360客户端
    TracePrint Plugin.ofcmd.Adb("-s " & test & " shell am start -n com.game.sgz.a360/com.youkia.gamecenter.GameCenterActivity")
End If

Dim MyString, packages, Devices

Event Form1.Button1.Click
    //获取ADB路径并写入配置
    Dim AdbPath
    AdbPath = Plugin.ofcmd.GetProcessAdbPath
    Form1.InputBox1.Text = AdbPath
    Delay 1000
    Plugin.ofcmd.BindAdb AdbPath
    //adb版本号
    test = Plugin.ofcmd.AdbVersion
    TracePrint test
    //设备列表
    TracePrint Plugin.ofcmd.Adb("Devices")
    Dim MyString, packages, Devices
    Devices = Plugin.ofcmd.GetDevices
    TracePrint Devices
    //拆分设备列表为数组
    MyString = Split(Devices, "127.0.0.1:", -1, 1) 
    For i = 0 To UBound(MyString)
        If MyString(i) <> "" Then 
        	//表格行是从0开始的,获取设备列表第一行是空行,所以这里其实是从第一行开始
            MyString(i) = "127.0.0.1:" & MyString(i)
            Form1.Grid1.SetItemText i , 0, MyString(i)
        End If
    Next
End Event



//获取当前启动的app的Activity
//TracePrint Plugin.ofcmd.Adb("-s 127.0.0.1:26944 shell dumpsys window windows|findstr Current")

//列出安装的应用
//packages = Plugin.ofcmd.Adb("-s 127.0.0.1:26944 shell pm list packages")
//TracePrint packages
//MyString = Split(packages, "package:", -1, 1)
//For Each a In MyString
//TracePrint a
//Next
//先Home键返回主界面
//TracePrint Plugin.ofcmd.Adb("-s " & test & " shell input keyevent 3")
