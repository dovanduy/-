[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=031c3249-a7e0-49ea-a36c-198ad393ba69
Description=我的脚本1
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Dim AdbPath
AdbPath = Form1.InputBox1.Text

Plugin.ofcmd.BindAdb AdbPath
test = Plugin.ofcmd.AdbVersion
TracePrint test


小精灵包名 = "com.mbmpmcmcmlnimnnlmp.dddfree"
//程序包名
海马玩报名 = "com.shouyou.sgzerq.hm"
包名360 = "com.game.sgz.a360"

//查看所有进程及内存占用等
Dim progressList
progressList = Plugin.ofcmd.Adb("shell ps")
If instr(progressList, 小精灵包名) > 0 Then 
	TracePrint "小精灵运行中"
Else 
	TracePrint "小精灵没了"
	//启动辅助
	//TracePrint Plugin.ofcmd.Adb("-s 127.0.0.1:26944 shell am start -n com.mbmpmcmcmlnimnnlmp.dddfree/com.cyjh.elfin.activity.SplashActivity")
	//这个activity可以跳过启动时的2段广告
	TracePrint Plugin.ofcmd.Adb("-s " & test & " shell am start -n com.mbmpmcmcmlnimnnlmp.dddfree/com.cyjh.elfin.activity.ElfinFreeActivity")
	Delay 15000
	
End If

If instr(progressList, 小精灵包名) > 0 Then 
	TracePrint "小精灵运行中"
Else 
	TracePrint "小精灵没了"
End If

//读取模拟器编号
test = Form1.Grid1.GetItemText(1, 0)
TracePrint test





//读取设置的平台
TracePrint Form1.ComboBox1.ListIndex
If Form1.ComboBox1.ListIndex = 0 Then 
    //运行海马玩客户端
    TracePrint Plugin.ofcmd.Adb("-s " & test & " shell am start -n com.shouyou.sgzerq.hm/com.youkia.gamecenter.GameCenterActivity")
ElseIf Form1.ComboBox1.ListIndex = 2
    //运行360客户端
    TracePrint Plugin.ofcmd.Adb("-s " & test & " shell am start -n com.game.sgz.a360/com.youkia.gamecenter.GameCenterActivity")
End If

Dim MyString, packages, Devices

Event Form1.Button1.Click
    //获取ADB路径并写入配置
    Dim AdbPath
    AdbPath = Plugin.ofcmd.GetProcessAdbPath
    Form1.InputBox1.Text = AdbPath
    Delay 1000
    Plugin.ofcmd.BindAdb AdbPath
    //adb版本号
    test = Plugin.ofcmd.AdbVersion
    TracePrint test
    //设备列表
    TracePrint Plugin.ofcmd.Adb("Devices")
    Dim MyString, packages, Devices
    Devices = Plugin.ofcmd.GetDevices
    TracePrint Devices
    //拆分设备列表为数组
    MyString = Split(Devices, "127.0.0.1:", -1, 1) 
    For i = 0 To UBound(MyString)
        If MyString(i) <> "" Then 
        	//表格行是从0开始的,获取设备列表第一行是空行,所以这里其实是从第一行开始
            MyString(i) = "127.0.0.1:" & MyString(i)
            Form1.Grid1.SetItemText i , 0, MyString(i)
        End If
    Next
End Event



//获取当前启动的app的Activity
//TracePrint Plugin.ofcmd.Adb("-s 127.0.0.1:26944 shell dumpsys window windows|findstr Current")

//列出安装的应用
//packages = Plugin.ofcmd.Adb("-s 127.0.0.1:26944 shell pm list packages")
//TracePrint packages
//MyString = Split(packages, "package:", -1, 1)
//For Each a In MyString
//TracePrint a
//Next
//先Home键返回主界面
//TracePrint Plugin.ofcmd.Adb("-s " & test & " shell input keyevent 3")
